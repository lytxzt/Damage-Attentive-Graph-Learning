import numpy as np
import random
import matplotlib.pyplot as plt
from scipy import stats
from matplotlib.backends.backend_agg import FigureCanvasAgg

x = [np.array([879.43548554,  78.36830946]), np.array([249.47842408, 173.60636889]), np.array([477.99200439, 861.91156006]), np.array([659.8601071 , 153.68115192]), np.array([796.87457207, 422.0021969 ]), np.array([364.67901674,  49.01403087]), np.array([867.8003521 , 479.89892442]), np.array([525.32592839, 843.5527345 ]), np.array([202.64875785, 217.19419863]), np.array([892.00685453, 506.45329571]), np.array([569.44038519, 860.43723899]), np.array([673.89239497, 894.43585228]), np.array([501.29025253, 866.7993773 ]), np.array([779.13793943, 618.31732177]), np.array([176.05418431, 726.28051754]), np.array([660.83648674, 700.13653565]), np.array([877.7110605 , 679.01861477]), np.array([740.0087266 , 222.99403318]), np.array([748.76728028, 852.33415538]), np.array([844.08679135, 515.60034086]), np.array([495.77951039, 497.52218602]), np.array([917.19268824,  77.63681008]), np.array([115.79302216, 328.13067638]), np.array([901.1456299 , 568.67980958]), np.array([140.53160098, 269.15585327]), np.array([737.61090067, 433.90982045]), np.array([605.31213377, 513.19311525]), np.array([137.38794017, 514.83458662]), np.array([597.84069755, 806.24768087]), np.array([489.88024891, 157.93315119]), np.array([367.08499313, 918.90490808]), np.array([549.37646513,  71.00066382]), np.array([680.23445776, 838.33307928]), np.array([690.08599869, 788.52484129]), np.array([ 97.70536815, 510.73400824]), np.array([896.07746786, 809.92015666]), np.array([154.70182785, 402.52053827]), np.array([585.14428732, 837.32348666]), np.array([489.77069134, 831.70355257]), np.array([366.3425293 ,  72.98046094]), np.array([591.49548386, 666.26641756]), np.array([622.83154298,  43.47118762]), np.array([254.85125742, 228.12115465]), np.array([136.97489697, 787.9783354 ]), np.array([109.17991637, 218.51324445]), np.array([185.13410797, 166.11433541]), np.array([932.56237712, 513.1335456 ]), np.array([114.52036959, 163.49113618]), np.array([228.63101301, 733.73675572]), np.array([460.05722081, 829.90246505]), np.array([685.0861212 , 615.84661886]), np.array([233.94668594, 222.27946475]), np.array([383.61705405, 492.18238679]), np.array([265.45065315, 774.41021728]), np.array([ 91.19632765, 899.54406652]), np.array([251.58137522, 757.40936281]), np.array([176.6896514 , 376.27117911]), np.array([930.64642361, 521.0299682 ]), np.array([631.6852419 ,  54.74400259]), np.array([548.02758791, 451.59451286]), np.array([603.49255381, 364.93295351]), np.array([707.18164117, 368.99383524]), np.array([604.15100103, 618.41424563]), np.array([747.90704325, 380.93365473]), np.array([452.23812954, 748.70251394]), np.array([561.90264897,  44.57640843]), np.array([283.66821308, 148.66244551]), np.array([597.88241196, 839.80454826]), np.array([152.58795162, 629.47509765]), np.array([697.63073969,  57.69218242]), np.array([256.81210374, 191.06208757]), np.array([767.93780496, 111.83127589]), np.array([281.23535151, 411.84722903]), np.array([659.91748063, 454.01046771]), np.array([713.82977184, 651.6362923 ]), np.array([393.80639603, 863.94641079]), np.array([165.77201872, 179.66377219]), np.array([137.2937541 , 659.37618357]), np.array([350.03756694, 810.18054206]), np.array([159.05249023, 190.58518985]), np.array([833.79847014, 708.15348434]), np.array([561.58538246, 631.50851154]), np.array([425.2052003 , 401.61663829]), np.array([231.87855561, 855.64074713]), np.array([499.137146  , 543.82763672]), np.array([916.83337598,  57.45813077]), np.array([598.88897665, 869.16253613]), np.array([947.3893434 , 562.66076709]), np.array([897.50335703, 471.85290524]), np.array([204.58274842, 877.763855  ]), np.array([670.03399652, 838.43243404]), np.array([542.15747068, 459.64843737]), np.array([785.33039433, 604.67941487]), np.array([161.57203673, 408.12731928]), np.array([740.02386472, 645.81817625]), np.array([609.95324527, 681.09570415]), np.array([476.94259631,  40.45876669]), np.array([738.73138315, 479.29977313]), np.array([318.522522  , 349.91424561]), np.array([865.91536498, 569.15194845])]

x = np.array(x)

G = np.dot(x, x.T)
H = np.tile(np.diag(G), (100, 1))
D = np.sqrt(H + H.T - 2*G)

A = np.where(D>120, 0, 1.0)
D = np.diag(np.sum(A, axis=1))
L = D - A

e_vals, e_vecs = np.linalg.eig(L)
num = np.sum(np.where(e_vals < 0.0001, 1, 0))
# print(D)
# DG = np.zeros((100,100))

# for i in range(100):
#     e = np.zeros((100, 100))
#     e[i][i] = 1.0
#     DG += e@G@e.T

# H1 = np.zeros((100,100))
# for i in range(100):
#     e = np.zeros((100, 100))
#     e[:,i] = 1.0
#     H1 += e@DG

L = np.eye(100) - A

e_vals, e_vecs = np.linalg.eig(L)
num1 = np.sum(np.where(e_vals < 0.000001, 1, 0))

print(num, num1)